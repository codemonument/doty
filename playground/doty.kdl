// doty.kdl - Comprehensive test configuration for doty playground
// Each test case has dedicated files/directories with explanatory content

//=============================================================================
// GLOBAL DEFAULTS
//=============================================================================

defaults {
    // Path resolution strategy: "config" (default) or "cwd"
    // "config" - resolve paths relative to doty.kdl location (recommended)
    // "cwd" - resolve paths relative to current working directory
    pathResolution "config"
}

//=============================================================================
// LINKFOLDER STRATEGY TESTS (Stow-like)
// Creates a single symbolic link for the entire directory
// Use Case: Directories where you want to track ALL files as a unit
//=============================================================================

// LF-1: Basic LinkFolder with block syntax
LinkFolder "source/test-lf-1-basic" {
    target "target/test-lf-1-basic"
}

// LF-2: LinkFolder with single-line syntax (compact format)
LinkFolder "source/test-lf-2-inline" target="target/test-lf-2-inline"

// LF-3: LinkFolder with renamed target (source and target names differ)
LinkFolder "source/test-lf-3-rename" {
    target "target/test-lf-3-renamed-folder"
}

//=============================================================================
// LINKFILESRECURSIVE STRATEGY TESTS (Dotter-like)
// Recreates directory structure and symlinks individual files
// Use Case: Selective file management, apps that dislike symlinked roots
//=============================================================================

// LFR-1: Single file linking with block syntax
LinkFilesRecursive "source/test-lfr-1-single-file.md" {
    target "target/test-lfr-1-single-file.md"
}

// LFR-2: Single file linking with inline syntax (compact format)
LinkFilesRecursive "source/test-lfr-2-inline.md" target="target/test-lfr-2-inline.md"

// LFR-3: Recursive directory linking (recreates structure, symlinks files)
LinkFilesRecursive "source/test-lfr-3-recursive" {
    target "target/test-lfr-3-recursive"
}

// LFR-4: Nested source to flat target (flattening structure)
LinkFilesRecursive "source/test-lfr-4-nested/deep/file.md" {
    target "target/test-lfr-4-flat.md"
}

// LFR-5: Nested source to nested target (preserving structure)
LinkFilesRecursive "source/test-lfr-5-nested/deep/file.md" {
    target "target/test-lfr-5-nested/deep/file.md"
}

//=============================================================================
// EDGE CASES AND SPECIAL SCENARIOS
//=============================================================================

// EDGE-1: Hidden file linking (dotfiles)
LinkFilesRecursive "source/.test-hidden" {
    target "target/.test-hidden"
}

// EDGE-2: Deep nesting - extracting file from 4 levels deep
LinkFilesRecursive "source/test-edge-2-deep/level1/level2/level3/file.md" {
    target "target/test-edge-2-extracted.md"
}

// EDGE-3: Same source to multiple targets (multiple symlinks to same file)
LinkFilesRecursive "source/test-edge-3-multi.md" {
    target "target/test-edge-3-copy1.md"
}

LinkFilesRecursive "source/test-edge-3-multi.md" {
    target "target/test-edge-3-copy2.md"
}

// EDGE-4: Selective file linking (only specific files from a directory)
LinkFilesRecursive "source/test-edge-4-mixed/tracked.md" {
    target "target/test-edge-4-mixed/tracked.md"
}
// Note: untracked.txt in the same directory is intentionally NOT linked

//=============================================================================
// PATH RESOLUTION DEMONSTRATION
//=============================================================================

// PATH-1: Config-based resolution (default, always active)
LinkFilesRecursive "source/test-path-1-config.md" {
    target "target/test-path-1-config.md"
}

// PATH-2: CWD-based resolution (commented out by default)
// To test: uncomment this and change defaults.pathResolution to "cwd"
// LinkFilesRecursive "source/test-path-2-cwd.md" {
//     target "target/test-path-2-cwd.md"
// }

//=============================================================================
// TESTING INSTRUCTIONS
//=============================================================================
//
// From playground directory:
//   doty link --dry-run    # Preview what will be linked
//   doty link              # Create all symlinks
//   doty status            # Check link status
//   doty clean             # Remove all symlinks
//
// From other directories:
//   doty -c playground/doty.kdl link --dry-run
//   doty -c playground/doty.kdl link
//
// Each test case file contains:
//   - Description of what it tests
//   - Expected results
//   - Use cases
//   - Configuration snippet
//
